<div class="box box-info" ng-repeat="(endpoint_index,endpoint) in service.endpoints"
    ng-class="isValidEndpoint(endpoint.endpoint) ? '' : 'box-danger'" id="e{{ endpoint_index }}">
    <div class="box-header with-border">
        <h3 class="box-title text-xl">
            <a href="/#!/endpoints?target={{endpoint_index}}">
                {{ endpoint.endpoint }} <span ng-hide="!hasWildcard(endpoint.endpoint) && !hasCatchall()" class="badge">Enterprise</span>
                <code class="small" ng-if="endpoint.input_query_strings.length > 0">
                    ?<span ng-repeat="qs in endpoint.input_query_strings">{{ qs }}=X{{ $last ? '' : '&' }}</span>
                </code>

            </a>
        </h3>

        <div class="box-tools pull-right">
            <span ng-hide="isValidEndpoint(endpoint.endpoint)" class="badge label-danger"><i class="fa fa-warning"></i>
                Error(s)</span>
            <span class="badge" ng-class="endpoint.output_encoding =='no-op' ? 'label-danger' : ''">{{
                endpoint.output_encoding }}</span>
            <span class="method_header badge method_{{ endpoint.method.length ? endpoint.method : 'GET' }}">{{
                endpoint.method.length ? endpoint.method : 'GET' }}</span>
            <button type="button" class="btn btn-box-tool"
                ng-click="deleteEndpoint(endpoint_index, 'This endpoint and all the information will be deleted. Do you want to proceed?')">
                <i class="fa fa-trash"></i></button>
        </div>
    </div>
    <!-- /.box-header -->
    <div class="box-body" id="endpoint-detail-{{endpoint_index}}"
        ng-if="selected_endpoint == endpoint_index && selected_endpoint.length">
        <form class="form-horizontal" novalidate>
            <fieldset>
                <div ng-class="isValidEndpoint(endpoint.endpoint) ? '' : 'has-error'" class="form-group form-group-lg">
                    <div class="col-md-12">
                        <p class="text-lg">
                            Endpoints are the paths of the <strong>API contract</strong> you are about to create for
                            someone else to rely on.
                            <a href="https://www.krakend.io/docs/enterprise/endpoints/" target="_blank">Introduction to
                                endpoints</a>.
                        </p>
                    </div>
                    <div class="col-md-8 col-sm-8">
                        <label>KrakenD Endpoint</label>
                        <input type="text" placeholder="/users/{username}" class="form-control input-md" required=""
                            ng-model="endpoint.endpoint">
                        <span class="help-block">This is the URI your clients will connect to. Must start with slash.
                            Use curly braces to insert <code>{endpoint_parameters}</code> that can be passed to the
                            backends. URLs ending in <code>/*</code> are treated as <strong>wildcards</strong>.</span>
                    </div>
                    <div class="col-md-2 col-sm-2">
                        <label>Method</label>
                        <select id="endpoint.method" ng-model="endpoint.method" name="endpoint.method"
                            class="form-control">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="PATCH">PATCH</option>
                            <option value="DELETE">DELETE</option>
                        </select>
                        <span class="help-block">Method</span>
                    </div>
                    <div class="col-md-2 col-sm-2">
                        <label>Output</label>
                        <select class="form-control" ng-model="endpoint.output_encoding" id="endpoint.output_encoding"
                            name="endpoint.output_encoding"
                            ng-change="setNoOpEncoding(endpoint_index, endpoint.output_encoding, '{{ endpoint.output_encoding }}', null)">
                            <option value="json">JSON object</option>
                            <option value="json-collection">JSON array</option>
                            <option value="fast-json">Fast JSON (EE)</option>
                            <option value="negotiate">Negotiate content</option>
                            <option value="string">String (text/plain)</option>
                            <option value="no-op">No-op (just proxy)</option>
                        </select>
                        <span class="help-block">Encode response as...</span>
                    </div>
                </div>

                <div class="nav-tabs-custom">
                    <ul class="nav nav-tabs">
                        <li class="active">
                            <a data-target="#tab-endpoint{{endpoint_index}}-parameter-forwarding" data-toggle="tab"
                                aria-expanded="true">Parameter
                                forwarding</a>
                        </li>
                        <li>
                            <a data-target="#tab-endpoint{{endpoint_index}}-auth" data-toggle="tab"
                                aria-expanded="false">Auth</a>
                        </li>
                        <li>
                            <a data-target="#tab-endpoint{{endpoint_index}}-throttling" data-toggle="tab"
                                aria-expanded="false">Throttling</a>
                        </li>
                        <li>
                            <a data-target="#tab-endpoint{{endpoint_index}}-security-validation" data-toggle="tab"
                                aria-expanded="false">Policies</a>
                        </li>
                        <li>
                            <a data-target="#tab-endpoint{{endpoint_index}}-manipulation" data-toggle="tab"
                                aria-expanded="false">Response manipulation</a>
                        </li>
                        <li>
                            <a data-target="#tab-endpoint{{endpoint_index}}-connection" data-toggle="tab"
                                aria-expanded="false">Connectivity options</a>
                        </li>
                        <li>
                            <a data-target="#tab-endpoint{{endpoint_index}}-documentation" data-toggle="tab"
                                aria-expanded="false">OpenAPI</a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane active" id="tab-endpoint{{endpoint_index}}-parameter-forwarding">
                            <p class="box text-lg"><span class="badge"><i class="fa fa-info"></i></span> KrakenD
                                applies <strong>zero-trust</strong> criteria to incoming requests. Unless explicitly
                                added below, no query strings, headers, or cookies are forwarded to the backend service.
                            </p>
                            <div class="form-group">
                                <div class="col-md-6">
                                    <label>Recognized query string parameters (?param=value)</label>
                                    <div class="input-group">
                                        <input class="form-control" placeholder="parameter_name" type="url"
                                            id="addQuerystring_{{ endpoint_index }}">
                                        <div class="input-group-btn">
                                            <button type="button" class="btn btn-success"
                                                ng-click="addQuerystring(endpoint_index)">
                                                <i class="fa fa-plus"></i> Add parameter
                                            </button>
                                        </div>
                                    </div>
                                    <span class="help-block">Query string parameters to be passed to the backends when
                                        present.
                                        Write only the name of the
                                        parameter, no question mark or equal symbols.</span>
                                    <div class="help-block">
                                        <ul class="list-inline">
                                            <li ng-repeat="(qs_index,qs) in endpoint.input_query_strings">
                                                <a class="badge code badge-remove"
                                                    ng-click="deleteQuerystring(qs_index,endpoint_index)"
                                                    title="Click to delettab-security-validatione parameter"><i
                                                        class="fa fa-times"></i> {{ qs
                                                    }} </a>
                                            </li>
                                            <li ng-if="!endpoint.input_query_strings.length">No query parameters are
                                                active yet.
                                                Typical
                                                parameters are <code>page</code>, <code>limit</code>,
                                                <code>search</code>...
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label>Headers passing to backend</label>
                                    <div class="input-group">
                                        <input class="form-control" placeholder="header_name" type="text" required=""
                                            ng-model="input_header">
                                        <div class="input-group-btn">
                                            <button type="button" class="btn btn-success"
                                                ng-click="addHeaderPassing(endpoint_index,input_header)">
                                                <i class="fa fa-plus"></i> Add header
                                            </button>
                                        </div>
                                    </div>
                                    <span class="help-block">Headers sent by the user that will reach your backend
                                        (e.g.: <code>Content-Type</code>). Add a
                                        single <code>*</code> to <strong>forward all headers</strong> (not recommended,
                                        security concerns)</span>
                                    <div class="input-group">
                                        <ul class="list-inline">
                                            <li ng-repeat="(index,header) in endpoint.input_headers">
                                                <a class="badge code badge-remove"
                                                    ng-click="deleteHeaderPassing(endpoint_index,index)"><i
                                                        class="fa fa-times"></i>
                                                    {{ header }}</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="tab-endpoint{{endpoint_index}}-auth">
                            <p class="box text-lg"><span class="badge"><i class="fa fa-info"></i></span>
                                Authorization and Authentication requirements for the end-user.</p>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <middleware template="jose_validator.html" namespace="'auth/validator'"
                                                data="endpoint"></middleware>
                                            <middleware template="jose_signer.html" namespace="'auth/signer'"
                                                data="endpoint"></middleware>
                                        </div>
                                        <div class="col-md-6">
                                            <middleware template="basic-authentication_endpoint.html"
                                                namespace="'auth/basic'" data="endpoint"></middleware>
                                            <div class="box box-info box-solid">
                                                <div class="box-header with-border">
                                                    <h3 class="box-title">
                                                        API-Key Authentication
                                                    </h3>
                                                    <div class="pull-right" ng-include src="'/src/app/layout/docs.html'"
                                                        ng-repeat="doc in [{'ee': true, 'url':'/authentication/api-keys/'}]">
                                                    </div>
                                                </div>
                                                <div class="box-body">
                                                    <p ng-if=" !hasServiceExtraConfig('auth/api-keys')">API Keys are
                                                        not
                                                        enabled
                                                        yet.</p>
                                                    <div class="form-group"
                                                        ng-if="hasServiceExtraConfig('auth/api-keys')">
                                                        <div class="col-md-12">
                                                            <p ng-if="!endpoint.extra_config['auth/api-keys'].roles">
                                                                <i class="fa fa-warning icon-warning"></i> This
                                                                endpoint
                                                                is not
                                                                protected by API Keys unless you select at least an
                                                                available role
                                                                below
                                                            </p>
                                                            <table class="table table-striped">
                                                                <tbody>
                                                                    <tr>
                                                                        <th width="50%">Available Roles</th>
                                                                        <th width="50%">Granted Roles</th>
                                                                    </tr>

                                                                    <tr>
                                                                        <td>
                                                                            <ul class="list-inline">
                                                                                <li
                                                                                    ng-repeat="role in getAPIKeyRoles()">
                                                                                    <a class="badge code badge-inverse"
                                                                                        ng-click="addAPIKeyRole(endpoint_index, role)">
                                                                                        {{ role }} <i
                                                                                            class="fa fa-arrow-right"></i></a>
                                                                                </li>
                                                                            </ul>
                                                                        </td>
                                                                        <td>
                                                                            <p
                                                                                ng-if="!endpoint.extra_config['auth/api-keys'].roles">
                                                                                <i
                                                                                    class="fa fa-warning icon-warning"></i>
                                                                                None
                                                                                selected
                                                                            </p>
                                                                            <ul class="list-inline">
                                                                                <li
                                                                                    ng-repeat="(role_index,role) in endpoint.extra_config['auth/api-keys'].roles">
                                                                                    <a class="badge code badge-remove"
                                                                                        ng-click="deleteAPIKeyRole(endpoint_index, role_index)"><i
                                                                                            class="fa fa-times"></i>
                                                                                        {{ role }}</a>
                                                                                </li>
                                                                            </ul>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <div class="col-md-12"
                                                            ng-if="endpoint.extra_config['auth/api-keys'].roles">
                                                            <label class="control-label">Rate limit by API
                                                                Key</label>
                                                            <div class="input-group">
                                                                <input class="form-control"
                                                                    ng-model="endpoint.extra_config['auth/api-keys'].client_max_rate"
                                                                    id="endpoint.extra_config['auth/api-keys'].client_max_rate"
                                                                    name="endpoint.extra_config['auth/api-keys'].client_max_rate"
                                                                    type="number">
                                                                <div class="input-group-addon">reqs/sec</div>
                                                            </div>
                                                            <span class="help-block">Maximum requests per second you
                                                                want to let
                                                                each API-keys do. Leave <code>0</code> or empty for
                                                                no
                                                                limit.
                                                            </span>
                                                        </div>
                                                    </div>

                                                    <p><a href="/#!/api-keys">Enable and configure API Keys</a></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="tab-endpoint{{endpoint_index}}-throttling">
                            <p class="box text-lg"><span class="badge"><i class="fa fa-info"></i></span>
                                The endpoint-level throttling options stablish a quota of usage of each endpoint and
                                sets the
                                foundations for the Quality of Service.</p>
                            <div class="form-group">
                                <div class="col-md-6">
                                    <p ng-include src="'/src/app/forms/endpoint_timeout.html'"></p>
                                    <plugin root="service" placement="endpoint" template="ipfilter.html"
                                        plugin="'ip-filter'" type="'plugin/req-resp-modifier'"></plugin>
                                </div>
                                <div class="col-md-6">
                                    <middleware data="endpoint" namespace="'qos/ratelimit/router'"
                                        template="ratelimit_router.html"></middleware>
                                    <plugin root="service" placement="endpoint" template="redis-ratelimit.html"
                                        plugin="'redis-ratelimit'" type="'plugin/http-server'"></plugin>

                                </div>
                            </div>
                        </div>

                        <div class="tab-pane" id="tab-endpoint{{endpoint_index}}-security-validation">
                            <p class="box text-lg"><span class="badge"><i class="fa fa-info"></i></span>
                                The policies engine lets you write custom rules validated on runtime during requests,
                                responses, and token validation.</p>
                            <div class="form-group">
                                <div class="col-md-6">
                                    <middleware template="security-policies.html" namespace="'security/policies'"
                                        data="endpoint"></middleware>
                                </div>
                                <div class="col-md-6">
                                    <middleware template="schema-validation.html" namespace="'validation/json-schema'"
                                        data="endpoint"></middleware>
                                    <plugin root="service" placement="endpoint"
                                        template="response-schema-validator.html" plugin="'response-schema-validator'"
                                        type="'plugin/req-resp-modifier'" ng-if="endpoint.output_encoding != 'no-op'">
                                    </plugin>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="tab-endpoint{{endpoint_index}}-manipulation">
                            <p class="box text-lg"><span class="badge"><i class="fa fa-info"></i></span>
                                When you manipulate data at the endpoint level, you have the last chance to work with
                                the aggregated data coming from all endpoints</p>
                            <div class="form-group">
                                <div class="col-md-6">
                                    <div ng-include src="'/src/app/forms/static-response.html'"></div>
                                    <middleware template="jmespath.html" namespace="'modifier/jmespath'"
                                        data="endpoint" ng-if="endpoint.output_encoding != 'no-op'"></middleware>
                                </div>
                                <div class="col-md-6">
                                    <plugin root="service" placement="endpoint" template="content-replacer.html"
                                        plugin="'content-replacer'" type="'plugin/req-resp-modifier'"></plugin>
                                    <middleware template="response-body-generator.html" namespace="'modifier/response-body-generator'"
                                        data="endpoint"></middleware>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="tab-endpoint{{endpoint_index}}-connection">
                            <p class="box text-lg"><span class="badge"><i class="fa fa-info"></i></span>
                                KrakenD connects to all backends in parallel. Here you can set special behaviors of this
                                endpoint when connecting to backends, like increasing the pressure to a backend to get
                                better response times, connect one by one, or use WebSockets.</p>
                            <div class="form-group">
                                <div class="col-md-6">
                                    <div ng-include src="'/src/app/forms/concurrent_calls.html'"></div>
                                    <div ng-include src="'/src/app/forms/sequential.html'"></div>
                                </div>
                                <div class="col-md-6">
                                    <middleware template="websocket.html" namespace="'websocket'" data="endpoint">
                                    </middleware>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="tab-endpoint{{endpoint_index}}-documentation">
                            <p class="box text-lg"><span class="badge"><i class="fa fa-info"></i></span> The
                                OpenAPI generator is a command-line utility embedded in the KrakenD binary, offering
                                OpenAPI import and export capabilities (for both Swagger v2 and OAS3).
                            </p>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <middleware template="openapi_endpoint.html" namespace="'documentation/openapi'"
                                        data="endpoint">
                                    </middleware>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-12">
                        <h3>Backends (Upstream) for <code>{{ endpoint.endpoint }}</code></h3>
                    </div>
                    <div class="col-md-12" ng-repeat="(backend_index,backend) in endpoint.backend">
                        <div class="box box-info box-solid">
                            <div class="box-header with-border">
                                <h3 class="box-title">
                                    <span
                                        class="method_header badge method_{{ backend.method.length ? backend.method : 'GET' }}">{{
                                        backend.method.length ? backend.method : 'GET' }}</span>
                                    {{ backend.host.length ? backend.host[0] : ''}}{{ backend.url_pattern }}
                                </h3>
                                <div class="box-tools pull-right">
                                    <span ng-show="!backend.host.length" class="badge label-danger"><i
                                            class="fa fa-warning"></i> Select a host!</span>
                                    <button type="button" class="btn btn-box-tool" data-widget="collapse">
                                        <i class="fa fa-minus"></i>
                                    </button>
                                    <button type="button" class="btn btn-box-tool"
                                        ng-click="deleteBackendQuery(endpoint_index,backend_index,'This endpoint and all the information will be deleted. Do you want to proceed?')">
                                        <i class="fa fa-trash"></i></button>

                                </div>
                                <!-- /.box-tools -->
                            </div>
                            <!-- /.box-header -->
                            <div class="box-body">
                                <div class="nav-tabs-custom">
                                    <ul class="nav nav-tabs">
                                        <li class="active">
                                            <a data-target="#tab-backend{{endpoint_index}}-{{backend_index}}-request"
                                                data-toggle="tab" aria-expanded="true">Request</a>
                                        </li>
                                        <li>
                                            <a data-target="#tab-backend{{endpoint_index}}-{{backend_index}}-response"
                                                data-toggle="tab" aria-expanded="false">Response manipulation</a>
                                        </li>
                                        <li>
                                            <a data-target="#tab-backend{{endpoint_index}}-{{backend_index}}-throttling"
                                                data-toggle="tab" aria-expanded="false">Throttling</a>
                                        </li>
                                        <li>
                                            <a data-target="#tab-backend{{endpoint_index}}-{{backend_index}}-connectivity"
                                                data-toggle="tab" aria-expanded="false">Connectivity</a>
                                        </li>
                                        <li>
                                            <a data-target="#tab-backend{{endpoint_index}}-{{backend_index}}-auth"
                                                data-toggle="tab" aria-expanded="false">Authentication</a>
                                        </li>
                                        <li>
                                            <a data-target="#tab-backend{{endpoint_index}}-{{backend_index}}-security-validation"
                                                data-toggle="tab" aria-expanded="false">Policies</a>
                                        </li>
                                    </ul>
                                    <div class="tab-content">
                                        <div class="tab-pane active"
                                            id="tab-backend{{endpoint_index}}-{{backend_index}}-request">
                                            <div class="form-group">
                                                <div class="col-md-12">
                                                    <p class="box text-lg"><span class="badge"><i
                                                                class="fa fa-info"></i></span> The request options
                                                        define how KrakenD interacts with the upstream service. </p>
                                                    <div ng-include src="'/src/app/forms/backend_request.html'"></div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="col-md-6">
                                                    <middleware data="backend" namespace="'backend/static-filesystem'" template="static-filesystem.html"></middleware>
                                                    <middleware data="backend" template="body-generator.html"
                                                        namespace="'modifier/body-generator'"></middleware>
                                                </div>
                                                <div class="col-md-6">
                                                    <middleware data="backend" template="martian.html"
                                                        namespace="'modifier/martian'"
                                                        ng-if="endpoint.output_encoding != 'no-op'"></middleware>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane"
                                            id="tab-backend{{endpoint_index}}-{{backend_index}}-response">
                                            <p ng-if="endpoint.output_encoding == 'no-op'" class="box text-lg">
                                                <span class="badge"><i class="fa fa-warning"></i></span>
                                                When using <code>no-op</code> (no operation) you are telling KrakenD to
                                                not perform any manipulation, almost all modules are now hidden.
                                            </p>
                                            <p ng-if="endpoint.output_encoding != 'no-op'" class="box text-lg">
                                                <span class="badge"><i class="fa fa-info"></i></span> You can modify
                                                the structure of the data before you return it to the endpoint where is
                                                aggregated with other endpoints.
                                            </p>
                                            <div class="form-group">
                                                <div class="col-md-6">
                                                    <div ng-include src="'/src/app/forms/manipulation.html'"
                                                        ng-if="endpoint.output_encoding != 'no-op'"></div>
                                                    <middleware data="backend" template="http_cache.html"
                                                        namespace="'qos/http-cache'"></middleware>
                                                </div>
                                                <div class="col-md-6">
                                                    <middleware template="jmespath.html" namespace="'modifier/jmespath'"
                                                        data="backend" ng-if="endpoint.output_encoding != 'no-op'">
                                                    </middleware>
                                                    <middleware template="response-body-generator.html" namespace="'modifier/response-body-generator'"
                                                        data="backend">
                                                    </middleware>
                                                    <plugin root="service" placement="backend"
                                                        template="content-replacer.html" plugin="'content-replacer'"
                                                        type="'plugin/req-resp-modifier'"
                                                        ng-if="endpoint.output_encoding != 'no-op'"></plugin>
                                                    <div ng-include src="'/src/app/forms/flatmap.html'"
                                                        ng-if="endpoint.output_encoding != 'no-op'"></div>
                                                    <middleware data="backend" template="martian.html"
                                                        namespace="'modifier/martian'"
                                                        ng-if="endpoint.output_encoding != 'no-op'"></middleware>


                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane"
                                            id="tab-backend{{endpoint_index}}-{{backend_index}}-throttling">
                                            <p class="box text-lg">
                                                <span class="badge"><i class="fa fa-info"></i></span> Control and limit
                                                the interaction between KrakenD and your service.
                                            </p>
                                            <div class="form-group">
                                                <div class="col-md-6">
                                                    <middleware data="backend" template="gobreaker.html"
                                                        namespace="'qos/circuit-breaker'">
                                                    </middleware>
                                                </div>
                                                <div class="col-md-6">
                                                    <middleware data="backend" namespace="'qos/ratelimit/proxy'"
                                                        template="ratelimit_backend.html"></middleware>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane"
                                            id="tab-backend{{endpoint_index}}-{{backend_index}}-connectivity">
                                            <p class="box text-lg">
                                                <span class="badge"><i class="fa fa-info"></i></span> Interaction with
                                                services beyond regular REST. Queues, lambdas, GraphQL and other
                                                services plugged as backend servers.
                                            </p>
                                            <div class="form-group">
                                                <div class="col-md-6">
                                                    <middleware data="backend" template="soap.html"
                                                        ng-click="backend.encoding = 'xml'; backend.method='POST'"
                                                        namespace="'backend/soap'"></middleware>
                                                    <middleware data="backend" template="http_client.html"
                                                        namespace="'backend/http/client'"></middleware>
                                                    <middleware data="backend" template="graphql.html"
                                                        namespace="'backend/graphql'"></middleware>
                                                    <middleware data="backend" template="amqp_consumer.html"
                                                        namespace="'backend/amqp/consumer'"></middleware>
                                                    <middleware data="backend" template="lambda.html"
                                                        namespace="'backend/lambda'">
                                                    </middleware>

                                                </div>
                                                <div class="col-md-6">
                                                    <middleware template="grpc_backend.html" namespace="'backend/grpc'"
                                                        data="backend"></middleware>
                                                    <middleware data="backend" template="pubsub_subscriber.html"
                                                        namespace="'backend/pubsub/susbcriber'"></middleware>
                                                    <middleware data="backend" template="pubsub_publisher.html"
                                                        namespace="'backend/pubsub/publisher'"></middleware>
                                                    <middleware data="backend" template="amqp_producer.html"
                                                        namespace="'backend/amqp/producer'"></middleware>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="tab-backend{{endpoint_index}}-{{backend_index}}-auth">
                                            <p class="box text-lg">
                                                <span class="badge"><i class="fa fa-info"></i></span> Set authentication
                                                requirements between KrakenD and your services. If you'd like to pass
                                                JWT tokens to the backend as well, add the <code>Authorization</code>
                                                header in the endpoint's parameter forwarding.
                                            </p>
                                            <div class="form-group">
                                                <div class="col-md-6">
                                                    <middleware data="backend"
                                                        inherit="service.extra_config['auth/client-credentials']"
                                                        template="oauth.html" namespace="'auth/client-credentials'">
                                                    </middleware>
                                                    <middleware data="backend"
                                                        template="gcp.html" namespace="'auth/gcp'">
                                                    </middleware>
                                                </div>

                                                <div class="col-md-6">
                                                    <middleware data="backend" template="ntlm.html" namespace="'auth/ntlm'"></middleware>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane"
                                            id="tab-backend{{endpoint_index}}-{{backend_index}}-security-validation">
                                            <p class="box text-lg">
                                                <span class="badge"><i class="fa fa-info"></i></span> Validate that
                                                request and responses adhere to your custom policies.
                                            </p>
                                            <div class="form-group">
                                                <div class="col-md-6">
                                                    <middleware template="security-policies.html"
                                                        namespace="'security/policies'" data="backend"></middleware>
                                                </div>
                                                <div class="col-md-6">
                                                    <plugin root="service" placement="backend"
                                                        template="response-schema-validator.html"
                                                        plugin="'response-schema-validator'"
                                                        type="'plugin/req-resp-modifier'"
                                                        ng-if="endpoint.output_encoding != 'no-op'">
                                                    </plugin>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>




                            </div><!-- ngif output_encoding != no-op -->
                            <!-- /.box-body -->
                        </div>

                        <div id="add-hosts-modal" class="modal fade" tabindex="-1" role="dialog">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span></button>
                                        <h4 class="modal-title">Add hosts</h4>
                                    </div>
                                    <div class="modal-body">
                                        <p>Define at least one host (upstream service) where KrakenD will take the data
                                            from.</p>
                                        <div ng-include src="'/src/app/forms/hosts.html'"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /Modal backend -->
                    </div>

                    <div class="col-md-12">
                        <button class="btn btn-primary" ng-click="addBackendQuery(endpoint_index)"
                            ng-if="! endpoint.backend || endpoint.backend.length < 1 || !(endpoint.output_encoding == 'no-op' && endpoint.backend.length > 0)">
                            <i class="fa fa-plus"></i>
                            Add backend query
                        </button>
                    </div>
                </div>
            </fieldset>
        </form>
    </div><!-- /.box-body -->
</div><!-- endpoint index -->
<button class="btn btn-lg btn-success" ng-click="addEndpoint()">Add endpoint</button>
<button class="btn btn-lg btn-success" ng-disabled="hasCatchall()" ng-click="addCatchall()">Add Catchall</button>